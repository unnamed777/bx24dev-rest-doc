<html>
        <head>
            <title>crm.item.update</title>
            <link href="style.css" type="text/css" rel="stylesheet"/>
        </head>
        <body>
        <h1 class="title">crm.item.update <a class="original-doc-link" href="https://dev.1c-bitrix.ru/rest_help/crm/dynamic/methodscrmitem/crm_item_update.php" target="_blank">↗︎</a></h1>
        <div class="content">
            
								<div class="tab">
<h3 class="tab-title">Описание и параметры</h3>

<pre class="syntax">crm.item.update({entityTypeId: number, id: number, fields: {})</pre>

<p>Метод обновит элемент с идентификатором <code>id</code> смарт-процесса с идентификатором <code>entityTypeId</code>.</p>

<p>При обновлении элемента производится стандартный ряд проверок, модификаций и автоматических действий:</p>
<ul>
	<li>проверяются права доступа;</li>
	<li>проверяется заполненность обязательных полей, если изменена стадия элемента в рамках того же направления;</li>
	<li>проверяется заполненность зависимых от стадий обязательных полей, если изменена стадия элемента в рамках того же направления;</li>
	<li>проверяется корректность заполнения полей;</li>
	<li>полям присваиваются значения по умолчанию;</li>
	<li><b>если перед сохранением оказывается, что никакие значения полей не были изменены, то сохранение не производится</b>;</li>
	<li><b>после сохранения запускаются роботы</b>.</li>
</ul>

<p>Метод вернет результат аналогичный вызову метода <a class="link" href="/rest_help/crm/dynamic/methodscrmitem/crm_item_get.php">crm.item.get</a> для обновленного элемента.</p>


<h4>Параметры</h4>

<table class="tnormal" width="100%">
	<tbody>
		<tr><th width="15%">Параметр</th> <th>Описание</th></tr>

<tr><td>entityTypeId</td><td>Идентификатор смарт-процесса.</td></tr>
<tr><td>id</td><td>Идентификатор элемента.</td></tr>
<tr><td>fields</td><td>Значение полей элемента.</td></tr>

</tbody>
</table>

</div>

<!------->

<div class="tab">

<h3 class="tab-title">Загрузить новый файл вместо старого (не множественное поле)</h3>

<p>Чтобы заменить файл в не множественном поле, просто загрузите новый файл. Старый будет удален автоматически.</p>

<pre class="syntax">{
	"fields": {
		"ufCrm1617027453943": [
			"myfile.pdf", 
			"...base64_encoded_file_content..."
		]
	}
}
</pre>

</div>

<!------->

<div class="tab">

<h3 class="tab-title">Удалить значение пользовательского поля типа файл</h3>
<br><br>
Для этого достаточно передать пустую строку (<code>''</code>) вместо значения
</div>

<!------->

<div class="tab">

<h3 class="tab-title">Оставить значение не множественного поля типа файл без изменений</h3>

<p>Самый простой вариант - не добавлять в <code>fields</code> ключ с этим полем. Но если надо и передать, и не изменить, то в качестве значения надо передать список, где по ключу <code>id</code> будет идентификатор файла

</p><pre class="syntax">{
	"fields": {
		"ufCrm1617027453943": {
			"id": 433
		}
	}
}
</pre>

<p><b>Если в <code>id</code> передать отличное от текущего значения, то значение поля обнулится и файл будет стёрт</b>.</p>

</div>

<!------->

<div class="tab">

<h3 class="tab-title">Работа с множественным полем типа файл</h3>

<p>Значение множественного поля - это массив. Каждый элемент массива подчиняется тем же правилам, что и для не множественных значений.</p>

<h4>Частичная перезапись значения множественного поля типа файл</h4>

<p>Например, сейчас в множественном поле типа файл находится значение <code>[12, 255, 44]</code>.</p>

<p>Необходимо оставить файлы <code>12</code> и <code>44</code>, а вместо <code>255</code> загрузить новый</p>

<p>Запрос должен выглядеть следующим образом:</p>

<pre class="syntax">{
	"fields": {
		"ufCrm1617027453943": [
			{
				"id": 12
			},
			{
				"id": 44
			},
			[
				"myNewFile.pdf", 
				"...base64_encoded_file_content..."
			]
		]
	}
}
</pre>

</div>

<!------->							
        </div>
        </body>
        </html>